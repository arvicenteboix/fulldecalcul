---
# Front matter
# Metainformació del document
title: Estratègies per a l'ús del full de càlcul
titlepage: true
subtitle: Funcions especials: BUSCARV(), BUSCARH(), Solver
author: 
- Alfredo Rafael Vicente Boix
lang: ca
page-background: img/bg.png

# portada
titlepage-rule-height: 2
titlepage-rule-color: AA0000
titlepage-text-color: AA0000
titlepage-background: ../portades/U2.png

# configuració de l'índex
toc-own-page: true
toc-title: Continguts
toc-depth: 2

# capçalera i peu
header-left: \thetitle
header-right: Curs 2023-2024
footer-left: CEFIRE València
footer-right: \thepage/\pageref{LastPage}

# Les figures que apareguen on les definim i centrades
float-placement-figure: H
caption-justification: centering 

# No volem numerar les linies de codi
listings-disable-line-numbers: true

# Configuracions dels paquets de latex
header-includes:

  #  imatges i subfigures
  - \usepackage{graphicx}
  - \usepackage{subfigure}
  - \usepackage{lastpage}



  #  - \usepackage{adjustbox}
  # marca d'aigua
  #- \usepackage{draftwatermark}
 # - \SetWatermarkText{\includegraphics{./img/Markdown.png}}
  #- \SetWatermarkText{Per revisar}
  #- \SetWatermarkScale{.5}
  #- \SetWatermarkAngle{20}
   
  # caixes d'avisos 
  - \usepackage{awesomebox}

  # text en columnes
  - \usepackage{multicol}
  - \setlength{\columnseprule}{1pt}
  - \setlength{\columnsep}{1em}

  # pàgines apaïsades
  - \usepackage{pdflscape}
  
  # per a permetre pandoc dins de blocs Latex
  - \newcommand{\hideFromPandoc}[1]{#1}
  - \hideFromPandoc {
      \let\Begin\begin
      \let\End\end
    }
 
# definició de les caixes d'avis
pandoc-latex-environment:
  noteblock: [note]
  tipblock: [tip]
  warningblock: [warning]
  cautionblock: [caution]
  importantblock: [important]
...


\vspace*{\fill}

![](img/cc.png){ height=50px }

este document està subjecte a una llicència creative commons que permet la seua difusió i ús comercial reconeixent sempre l'autoria del seu creador. este document es troba per a ser modificat al següent repositori de github:
<!-- CANVIAR L'ENLLAÇ -->
[https://github.com/arvicenteboix/fulldecalcul](https://github.com/arvicenteboix/fulldecalcul)
\newpage


# INTRODUCCIÓ

En esta unitat veurem les funcions BUSCARV i BUSCARH, que són funcions per a buscar elements en una matriu donada. Després farem una ullada a Solver, on veurem un exemple però podrem utilitzar per a resoldre xicotetes equacions.


# BUSCARV i BUSCARH

Es tracta de funcions de búsqueda de dades. Aquestes funcions ens permeten buscar la referència d'un valor dins d'un rang.

```
=BUSCARV( Criteri de búsqueda; matriu_de_búsqueda; Índex; ordenat )
```

## Exemple BUSCARV()

Anem a buscar un valor en la primera columna d'un rang, esta ens retorna un valor en la mateixa fila des d'una columna que especifiquem. Per exemple:

Suposem que tenim una llista d'estudiants amb les seues amb qualificacions i volem buscar la d'un estudiant específic. La nostra taula és:

| Estudiant | Nota |
|-----------|------|
| Anna      | NT   |
| Alfred    | BE   |
| Carla     | EX   |
| David     | SF   |
| Javi      | EX   |

Si volem buscar la nota de l'estudiant "Carla", utilitzarem la funció **BUSCARV** de la següent manera:

```excel
=BUSCARV("Carla"; A2:B6; 2; FALSO())
```

Aquesta fórmula significa:

- **"Carla"**: És el valor que volem buscar.
- **A2:B6**: És el rang on volem buscar. "Carla" s'ha de trobar en la primera columna d'aquest rang. Esta part és molt important.
- **2**: És el número de columna del rang des d'on volem recuperar el valor. En aquest cas, 2 perquè la nota està en la segona columna. Si possarem 1, ens tornaria "Carla, ja que és el valor que ha buscat.
- **FALSO()**: Indica que volem una coincidència exacta. Si possarem VERDADERO(), podríem posar per exemple Carlota i buscaría una semblança amb el que estem buscant.

Quan introduïm aquesta fórmula, Excel buscarà "Carla" en la primera columna del rang A2:B6 i retornarà el valor de la segona columna, que és la nota, i en aquest cas seria **EX**.

En el següent exemple:

| Estudiant | Nota | Nota2 |
|-----------|------|-------|
| Anna      | NT   |  NT   |
| Alfred    | BE   |  NT   |
| Carla     | EX   |  SF   |
| David     | SF   |  BE   |
| Javi      | EX   |  IN   |

Si escribirem la següent fórmula:

```excel
=BUSCARV("Carla"; A2:B6; 3; FALSO())
```

Ens donaría el valor SF, ja que és el valor de la columna 3.

## Exemple BUSCARH()

La funció **BUSCARH** és similar a **BUSCARV**, però en comptes de buscar verticalment en una columna, **BUSCARH** busca horitzontalment en una fila. És útil quan la informació que volem trobar està organitzada en files en lloc de columnes.

Imagina que tenim una taula amb els dies de la setmana i les temperatures màximes que s'han registrat. Volem trobar la temperatura màxima d'un dia específic. La nostra taula podria ser així:

| Dia       | Dilluns | Dimarts | Dimecres | Dijous | Divendres | Dissabte | Diumenge |
|-----------|---------|---------|----------|--------|-----------|----------|----------|
| Temp. Màx | 22      | 24      | 19       | 21     | 23        | 25       | 20       |

Si volem buscar la temperatura màxima del **Dijous**, utilitzarem la funció **BUSCARH** de la següent manera:

```excel
=BUSCARH("Dijous"; A1:H2; 2; falso())
```

Aquesta fórmula significa:

- **"Dijous"**: És el valor que volem buscar.
- **A1:H2**: És el rang on volem buscar. "Dijous" s'ha de trobar en la primera fila d'aquest rang.
- **2**: És el número de fila del rang des d'on volem recuperar el valor. En aquest cas, 2 perquè la temperatura està en la segona fila.
- **FALSO()**: Indica que volem una coincidència exacta.

Quan introduïm aquesta fórmula, el full de càlcul buscarà "Dijous" en la primera fila del rang A1:H2 i retornarà el valor de la segona fila, que és la temperatura màxima, i en aquest cas seria **21**.

# Solver

Per a explicar esta ferramenta sempre es partix d'un exemple que puga ser més o menys clar, imagina que tens una caixa plena de llepolies de diferents colors i vols repartir-los entre els teus amics de la manera més justa possible, però també vols quedar-te amb la major quantitat de llepolies verdes, que són els teus preferits. Així com funciona el Solver.

**Solver** és una eina que existeix, tan per a Excel com per a Libreoffice, que ens ajuda a trobar la millor solució a un problema, com repartir les llepolies. Ens permet dir-li al full de càlcul què volem maximitzar o minimitzar (com les llepolies verdes) i quines són les regles que no podem trencar (com no donar més de 10 llepolies a cada amic).

:::note
Si voleu saber més, Solver és una ferramenta de programació matemàtica lineal. Hi ha multitud d'informació al respecte i s'utilitze en ambients empresarials per a temes de producció.[^1]
:::

[^1]: [https://es.wikipedia.org/wiki/Programaci%C3%B3n_lineal](https://es.wikipedia.org/wiki/Programaci%C3%B3n_lineal)

Per a usar el Solver, primer hem de tenir clar tres coses:

1. **Què volem aconseguir?** Això és la nostra **meta** o **objectiu**. Pot ser maximitzar alguna cosa, com els beneficis, o minimitzar, com el cost.

2. **Què podem canviar?** Això són les nostres **variables**. Són les coses que podem ajustar per a intentar aconseguir la nostra meta. Com ara, quantes llepolies de cada color donem als nostres amics.

3. **Quines són les regles?** Això són les **restriccions**. Són les normes que no podem passar per alt. Com ara, no podem donar més llepolies de les que tenim en la caixa.

Quan tenim tot això clar, configurem Solver i ell "juga" amb les variables dins de les regles fins a trobar la millor manera de aconseguir l'objectiu, encara que, a vegades, ens dona valors aproximats. És com un joc de trencaclosques on Excel prova diferents combinacions fins a trobar la que millor funciona.

I així és com el Solver ens pot ajudar a prendre decisions i resoldre problemes de manera fàcil i senzilla. Però vegem algun exemple.

# Exemple 1

Tenim dos tipus de productes: camises i pantalons. Cada camisa ens dóna un benefici de 15€ i cada pantaló de 20€. Però, tenim algunes restriccions:

- Només podem fabricar un màxim de 100 unitats entre camises i pantalons a la setmana a causa de la capacitat de producció.
- Per qüestions de demanda del mercat, hem de fabricar almenys 10 camises i 10 pantalons cada setmana.
- El cost de fabricació per unitat és de 8€ per a les camises i de 10€ per als pantalons, i no volem superar un cost total de 1200€ a la setmana.

Amb estes dades, podem configurar el nostre model a Excel de la següent manera:

1. **Variables de decisió**:
   - **Cèl·la B2**: Nombre de camises a fabricar.
   - **Cèl·la B3**: Nombre de pantalons a fabricar.

2. **Funció objectiu**:
   - **Cèl·la B4**: Benefici total. La fórmula seria `=15*B2 + 20*B3`.

3. **Restriccions**:
   - **Cèl·la B5**: Total unitats fabricades. La fórmula seria `=B2 + B3`, i este valor ha de ser menor o igual a 100.
   - **Cèl·la B6**: Cost total de fabricació. La fórmula seria `=8*B2 + 10*B3`, i este valor ha de ser menor o igual a 1200€.
   - **Cèl·la B2** ha de ser major o igual a 10.
   - **Cèl·la B3** ha de ser major o igual a 10.

Ara, obrim la ferramenta Solver i configurem els següents paràmetres:

- **Establir objectiu**: Cèl·la B4.
- **Per a maximitzar**: Seleccionem 'Max'.
- **Variables de canvi**: Cèl·les B2 i B3.
- **Afegir restriccions**:
  - B5 <= 100
  - B6 <= 1200
  - B2 >= 10
  - B3 >= 10

Una vegada tot està configurat, fem clic en 'Resoldre' i Solver trobarà la combinació òptima de camises i pantalons a fabricar per a maximitzar els beneficis sense superar les restriccions establertes.

# SUMAR.SI

Altra de les fórmules que resulten interessants i que anem a introduör, és la de sumar donades unes condicions. És molt semblant a BUSCARV(), ja que busca uns valors i suma tots els valors que coincidixen amb eixe criteri. Imaginem que tenim una sèrie de despses amb diferents conceptes.

|  Concepte | Despesa |
| ----- | -- |
| 	Lloguer de les instal·lacions 	 | 		 | 
| 	Lloguer Furgona cotxe gasoil 	 | 		 | 
| 	Lloguer Autobus 	 | 		 | 
| 	Samarretes i sudaderes 	 | 		 | 
| 	Excursió	 | 		 | 
| 	Activitats I material comú	 | 		 | 
| 	Manutenció	 | 		 | 
| 	Farmàcia	 | 		 | 
| 	Marxa	 | 		 | 
| 	Imprevistos I sopar	 | 		 | 

Per altra banda, tenim un full anomenat factures on anem apuntant totes les despeses:

[Full de factures](img/1.png)

En PARTIDA podem tindre les cel·les validades per a que ens assigne eixe moviment a una partida específica:

[Full de factures](img/2.png)

El que ens permet SUMAR.SI és buscar totes les partides assignades a un concepte específic i sumar-les. L'esquema de la funció seria:

```excel
=SUMAR.SI(Interval;Criteri_búsqueda;Interval_suma)
```

De manera que en el nostre cas podríem anomenar als intervals de la següent manera:

[Rangs](img/3.png)

:::tip
Fixe-vos que agafem tota la columna D:D i E:E, això no ens importa ja que les files d'abans i de després no ens molesten, de manera que podem anar afegint línies a factures i no ens cal tindre en compte si tenim que canviar el rang.
:::

Així podríem tenir una fórmula del tipus:

```excel
=SUMAR.SI(Factures.D:D;I9;Factures.E:E)
```

On I9 correpondria a la cel·la on tenim el nostre concepte, de manera que tindríem un resultat semblant a este:

[Conceptes sumats](img/4.png)

# Cas pràctic 

En aquest punt, vos plantegem la tasca que vos anem a demanar. Anem a imaginar que hem organitzat un eixida amb els nostres alumnes a un paratge natural i anem a passar una setmana allí. Hem decidit preparar-nos un full de càlcul per a no tindre que pensar massa i anar anotant les despeses que anem tenint a un full anomenat pressupost

