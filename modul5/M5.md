---
# Front matter
# Metainformació del document
title: Estratègies per a l'ús del full de càlcul
titlepage: true
subtitle: "Mòdul V: Estratègies ambal tre programari" 
author: 
- Alfredo Rafael Vicente Boix
lang: ca

# portada
titlepage-rule-height: 2
titlepage-rule-color: AA0000
titlepage-text-color: AA0000
titlepage-background: ../portades/U2.png

# configuració de l'índex
toc-own-page: true
toc-title: Continguts
toc-depth: 2

# capçalera i peu
header-left: \thetitle
header-right: Curs 2023-2024
footer-left: CEFIRE València
footer-right: \thepage/\pageref{LastPage}

# Les figures que apareguen on les definim i centrades
float-placement-figure: H
caption-justification: centering 

# No volem numerar les linies de codi
listings-disable-line-numbers: true

# Configuracions dels paquets de latex
header-includes:

  #  imatges i subfigures
  - \usepackage{graphicx}
  - \usepackage{subfigure}
  - \usepackage{lastpage}



  #  - \usepackage{adjustbox}
  # marca d'aigua
  #- \usepackage{draftwatermark}
 # - \SetWatermarkText{\includegraphics{./img/Markdown.png}}
  #- \SetWatermarkText{Per revisar}
  #- \SetWatermarkScale{.5}
  #- \SetWatermarkAngle{20}
   
  # caixes d'avisos 
  - \usepackage{awesomebox}

  # text en columnes
  - \usepackage{multicol}
  - \setlength{\columnseprule}{1pt}
  - \setlength{\columnsep}{1em}

  # pàgines apaïsades
  - \usepackage{pdflscape}
  
  # per a permetre pandoc dins de blocs Latex
  - \newcommand{\hideFromPandoc}[1]{#1}
  - \hideFromPandoc {
      \let\Begin\begin
      \let\End\end
    }
 
# definició de les caixes d'avis
pandoc-latex-environment:
  noteblock: [note]
  tipblock: [tip]
  warningblock: [warning]
  cautionblock: [caution]
  importantblock: [important]
...

\vspace*{\fill}

![](img/cc.png){ height=50px }

Este document està subjecte a una llicència Creative Commons que permet la seua difusió i ús comercial reconeixent sempre l'autoria del seu creador. Aquest document es troba per a ser modificat al següent repositori de github:
<!-- CANVIAR L'ENLLAÇ -->
[https://github.com/arvicenteboix/fulldecalcul](https://github.com/arvicenteboix/fulldecalcul)
\newpage


# INTRODUCCIÓ

Les macros als fulls de càlcul són operacions que podem realitzar de manera automatitzada. En aquest mòdul veurem com realitzar operacions molt senzilles amb macros però que ens poden donar resultats molt vistosos.

Les macros poden estar escrites en diferents llenguatges de programació, LibreOffice Basic, BeanShell, JavaScript i Python, nosaltres ens centrarem en aquest primer ja que té un mode de compatibilitat amb Excel. Les macros no sempre són compatibles entre Excel i Libreoffice Calc i moltes vegades quan creen una macro en un u altre sistema sempre tindrem que retocar-la.

Així mateix també veurem com crear *dialogs*[^1] per a dotar de major usabilitat el full de càlcul. Principalment per a aquelles persones que no són usuàries del nostre full de càlcul.

Partirem de l'exemple que teníem abans i anirem explicant poc a poc a través d'exemples, això sí... Aneu a escriure codi, poc, però les macros al final són línies de codi. Aquest mòdul vos facilitarà ferramentes bàsiques per a crear macros i a partir d'ahí podeu complicar les coses tot el que vullgueu.

[^1]: Un diàleg en programació és una finestra que mostra informació a l’usuari o sol·licita una entrada d’usuari. Aquesta eina facilita la interacció entre l’usuari i el sistema o aplicació.

# Organitzant Macros i diàlegs

**Habilitar macros**



# Gravador de macros


## Botons de formularis


# La meua primera macro






# Macros.


## Nocions bàsiques

### MsgBox()

## Variables (Dim)

## Comentaris (REM)

## Functions

### Amb Argument

```
Function TestMax(x, y)
If x >= y Then
TestMax = x
Else
TestMax = y
End If
End Function
```

## Objectes

* **ThisComponent**
  - .getSheets() o .Sheets 
    - .getByIndex(INDEX_FULL)
    - .getByName(NOM_FULL)
    - .getCount()


Podríem tindre el nostre full:

```
el_nostre_full = ThisComponent.getSheets().getByIndex(0)
```
* **el_nostre_full**
  - .getCellByPosition(0, 0)
  - .getCellRangeByName(NOM_CEL·LA_O_RANG)
    - .setValue(VALOR_A_DONAR)
    - .setFormula("=A1+A2")
    - .getValue()
    - .getString()
    - .getFormula()






## Copilot al rescat


# Utilitzant macros. Ús dels dialogs.


# Estratègies